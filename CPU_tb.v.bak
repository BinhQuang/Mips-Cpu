`timescale 1ns / 1ps

module CPU_tb;

    reg clk;
    reg rst_n;
    wire [31:0] instr_out;
    wire aluZero_out;

    // Instantiate the CPU
    CPU uut (
        .clk(clk),
        .rst_n(rst_n),
        .instr_out(instr_out),
        .aluZero_out(aluZero_out)
    );

    // Clock generation
    initial clk = 0;
    always #5 clk = ~clk; // 10ns period

    initial begin
        $display("Start simulation");

        // Load instructions into ROM
        $readmemh("program.hex", uut.DP.instr_rom.rom);

        // Apply reset
        rst_n = 0;
        #20;
        rst_n = 1;

        // Monitor key signals
        $monitor("Time=%0t | instr=0x%h | zero=%b", $time, instr_out, aluZero_out);

        // Run for 200ns (~20 cycles)
        #200;
        $finish;
    end

endmodule
